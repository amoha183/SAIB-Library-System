<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SAIB Library - Super Admin Dashboard</title>
    <link rel="stylesheet" href="assets/css/style.css">
</head>
<body class="admin-page">
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="navbar-container">
            <div class="navbar-brand">
                <img src="saiblogo.png" alt="SAIB Library Logo" class="navbar-logo">
                <h2>SAIB Library</h2>
            </div>
            <ul class="navbar-menu">
                <li><a href="customer.html" class="nav-link">Customer View</a></li>
                <li><a href="superadmin.html" class="nav-link active">Super Admin Dashboard</a></li>
                <li class="profile-dropdown">
                    <button class="profile-btn" onclick="toggleProfileDropdown()">
                        <div class="profile-avatar" id="profileAvatar">
                            <span id="profileInitials">SA</span>
                        </div>
                    </button>
                    <div class="profile-dropdown-menu" id="profileDropdownMenu">
                        <div class="profile-dropdown-header">
                            <span class="profile-name" id="dropdownUserName">Super Admin</span>
                            <span class="profile-role" id="dropdownUserRole">Super Administrator</span>
                        </div>
                        <div class="profile-dropdown-divider"></div>
                        <a href="profile.html" class="profile-dropdown-item">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                <circle cx="12" cy="7" r="4"></circle>
                            </svg>
                            View Profile
                        </a>
                        <a href="#" class="profile-dropdown-item" onclick="handleLogout(); return false;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                                <polyline points="16 17 21 12 16 7"></polyline>
                                <line x1="21" y1="12" x2="9" y2="12"></line>
                            </svg>
                            Logout
                        </a>
                    </div>
                </li>
            </ul>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <!-- Page Header -->
            <div class="page-header">
                <div class="header-content">
                    <h1 class="page-title">Super Admin Dashboard</h1>
                    <p class="page-subtitle">Manage books, customers, and administrators</p>
                </div>
            </div>

            <!-- Tabs Navigation -->
            <div class="tabs-container">
                <button class="tab-button active" onclick="switchTab('books')">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="tab-icon">
                        <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                        <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                    </svg>
                    Books Management
                </button>
                <button class="tab-button" onclick="switchTab('customers')">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="tab-icon">
                        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                        <circle cx="9" cy="7" r="4"></circle>
                        <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                        <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                    </svg>
                    Customers
                </button>
                <button class="tab-button" onclick="switchTab('admins')">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="tab-icon">
                        <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                        <circle cx="8.5" cy="7" r="4"></circle>
                        <polyline points="17 11 19 13 23 9"></polyline>
                    </svg>
                    Administrators
                </button>
                <button class="tab-button" onclick="switchTab('borrowings')">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="tab-icon">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                        <line x1="16" y1="13" x2="8" y2="13"></line>
                        <line x1="16" y1="17" x2="8" y2="17"></line>
                        <polyline points="10 9 9 9 8 9"></polyline>
                    </svg>
                    Borrowings
                </button>
            </div>

            <!-- Books Tab Content -->
            <div id="booksTab" class="tab-content active">
                <div class="tab-header">
                    <h2>Book Management</h2>
                    <button class="btn btn-primary" onclick="openAddBookModal()">
                        <span class="btn-icon">+</span> Add New Book
                    </button>
                </div>

                <!-- Search and Filter Section for Books -->
                <div class="admin-filters-container">
                    <div class="admin-search-row">
                        <!-- Search Bar -->
                        <div class="admin-search-box">
                            <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="11" cy="11" r="8"></circle>
                                <path d="m21 21-4.35-4.35"></path>
                            </svg>
                            <input type="text" id="adminBookSearch" class="admin-search-input" placeholder="Search by title, author, ISBN..." onkeyup="filterAdminBooks()">
                        </div>

                        <!-- Sort Dropdown -->
                        <div class="admin-sort-box">
                            <label for="adminBookSort" class="sort-label">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="sort-icon">
                                    <path d="M3 6h18M7 12h10M11 18h2"></path>
                                </svg>
                                Sort:
                            </label>
                            <select id="adminBookSort" class="filter-select" onchange="filterAdminBooks()">
                                <option value="default">Default</option>
                                <option value="title-asc">Title (A-Z)</option>
                                <option value="title-desc">Title (Z-A)</option>
                                <option value="author-asc">Author (A-Z)</option>
                                <option value="author-desc">Author (Z-A)</option>
                                <option value="year-asc">Year (Oldest)</option>
                                <option value="year-desc">Year (Newest)</option>
                            </select>
                        </div>
                    </div>

                    <div class="admin-filter-row">
                        <!-- Category Filter -->
                        <div class="admin-filter-group">
                            <label for="adminCategoryFilter" class="filter-label">Category</label>
                            <select id="adminCategoryFilter" class="filter-select" onchange="filterAdminBooks()">
                                <option value="">All Categories</option>
                                <!-- Options populated dynamically -->
                            </select>
                        </div>

                        <!-- Availability Filter -->
                        <div class="admin-filter-group">
                            <label for="adminAvailabilityFilter" class="filter-label">Availability</label>
                            <select id="adminAvailabilityFilter" class="filter-select" onchange="filterAdminBooks()">
                                <option value="">All Books</option>
                                <option value="available">Available</option>
                                <option value="borrowed">All Borrowed</option>
                            </select>
                        </div>

                        <!-- Clear Filters Button -->
                        <button type="button" class="btn btn-secondary btn-clear-filters" onclick="clearAdminBookFilters()">
                            Clear Filters
                        </button>
                    </div>
                </div>

                <div class="table-container">
                    <table class="books-table" id="booksTable">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Title</th>
                                <th>Author</th>
                                <th>Category</th>
                                <th>Year</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="booksTableBody">
                            <!-- Books will be dynamically rendered here -->
                        </tbody>
                    </table>

                    <div id="booksEmptyState" class="empty-state" style="display: none;">
                        <p>No books found. Click "Add New Book" to get started.</p>
                    </div>
                </div>
            </div>

            <!-- Customers Tab Content -->
            <div id="customersTab" class="tab-content">
                <div class="tab-header">
                    <h2>Customer Management</h2>
                    <button class="btn btn-primary" onclick="openAddUserModal('customer')">
                        <span class="btn-icon">+</span> Add New Customer
                    </button>
                </div>

                <!-- Search and Filter Section for Customers -->
                <div class="admin-filters-container">
                    <div class="admin-search-row">
                        <!-- Search Bar -->
                        <div class="admin-search-box">
                            <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="11" cy="11" r="8"></circle>
                                <path d="m21 21-4.35-4.35"></path>
                            </svg>
                            <input type="text" id="adminCustomerSearch" class="admin-search-input" placeholder="Search by name, email, phone..." onkeyup="filterAdminCustomers()">
                        </div>

                        <!-- Sort Dropdown -->
                        <div class="admin-sort-box">
                            <label for="adminCustomerSort" class="sort-label">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="sort-icon">
                                    <path d="M3 6h18M7 12h10M11 18h2"></path>
                                </svg>
                                Sort:
                            </label>
                            <select id="adminCustomerSort" class="filter-select" onchange="filterAdminCustomers()">
                                <option value="default">Default</option>
                                <option value="name-asc">Name (A-Z)</option>
                                <option value="name-desc">Name (Z-A)</option>
                                <option value="email-asc">Email (A-Z)</option>
                                <option value="email-desc">Email (Z-A)</option>
                                <option value="date-asc">Joined (Oldest)</option>
                                <option value="date-desc">Joined (Newest)</option>
                            </select>
                        </div>
                    </div>

                    <div class="admin-filter-row">
                        <!-- Clear Filters Button -->
                        <button type="button" class="btn btn-secondary btn-clear-filters" onclick="clearAdminCustomerFilters()">
                            Clear Filters
                        </button>
                    </div>
                </div>

                <div class="table-container">
                    <table class="books-table" id="customersTable">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Phone</th>
                                <th>Joined Date</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="customersTableBody">
                            <!-- Customers will be dynamically rendered here -->
                        </tbody>
                    </table>
                    
                    <div id="customersEmptyState" class="empty-state" style="display: none;">
                        <p>No customers found. Click "Add New Customer" to get started.</p>
                    </div>
                </div>
            </div>

            <!-- Admins Tab Content -->
            <div id="adminsTab" class="tab-content">
                <div class="tab-header">
                    <h2>Administrator Management</h2>
                    <button class="btn btn-primary" onclick="openAddUserModal('admin')">
                        <span class="btn-icon">+</span> Add New Admin
                    </button>
                </div>

                <!-- Search and Filter Section for Admins -->
                <div class="admin-filters-container">
                    <div class="admin-search-row">
                        <!-- Search Bar -->
                        <div class="admin-search-box">
                            <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="11" cy="11" r="8"></circle>
                                <path d="m21 21-4.35-4.35"></path>
                            </svg>
                            <input type="text" id="adminAdminSearch" class="admin-search-input" placeholder="Search by name, email, phone..." onkeyup="filterAdminAdmins()">
                        </div>

                        <!-- Sort Dropdown -->
                        <div class="admin-sort-box">
                            <label for="adminAdminSort" class="sort-label">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="sort-icon">
                                    <path d="M3 6h18M7 12h10M11 18h2"></path>
                                </svg>
                                Sort:
                            </label>
                            <select id="adminAdminSort" class="filter-select" onchange="filterAdminAdmins()">
                                <option value="default">Default</option>
                                <option value="name-asc">Name (A-Z)</option>
                                <option value="name-desc">Name (Z-A)</option>
                                <option value="email-asc">Email (A-Z)</option>
                                <option value="email-desc">Email (Z-A)</option>
                            </select>
                        </div>
                    </div>

                    <div class="admin-filter-row">
                        <!-- Role Filter -->
                        <div class="admin-filter-group">
                            <label for="adminRoleFilter" class="filter-label">Role</label>
                            <select id="adminRoleFilter" class="filter-select" onchange="filterAdminAdmins()">
                                <option value="">All Roles</option>
                                <option value="Admin">Admin</option>
                                <option value="Super Admin">Super Admin</option>
                            </select>
                        </div>

                        <!-- Clear Filters Button -->
                        <button type="button" class="btn btn-secondary btn-clear-filters" onclick="clearAdminAdminFilters()">
                            Clear Filters
                        </button>
                    </div>
                </div>

                <div class="table-container">
                    <table class="books-table" id="adminsTable">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Phone</th>
                                <th>Role</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="adminsTableBody">
                            <!-- Admins will be dynamically rendered here -->
                        </tbody>
                    </table>
                    
                    <div id="adminsEmptyState" class="empty-state" style="display: none;">
                        <p>No administrators found. Click "Add New Admin" to get started.</p>
                    </div>
                </div>
            </div>

            <!-- Borrowings Tab Content -->
            <div id="borrowingsTab" class="tab-content">
                <div class="tab-header">
                    <h2>Borrowings Management</h2>
                    <button class="btn btn-secondary" onclick="refreshBorrowings()">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="btn-icon-svg">
                            <polyline points="23 4 23 10 17 10"></polyline>
                            <polyline points="1 20 1 14 7 14"></polyline>
                            <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
                        </svg>
                        Refresh
                    </button>
                </div>

                <!-- Search and Filter Section for Borrowings -->
                <div class="admin-filters-container">
                    <div class="admin-search-row">
                        <!-- Search Bar -->
                        <div class="admin-search-box">
                            <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="11" cy="11" r="8"></circle>
                                <path d="m21 21-4.35-4.35"></path>
                            </svg>
                            <input type="text" id="borrowingsSearch" class="admin-search-input" placeholder="Search by book title, customer name..." onkeyup="filterBorrowings()">
                        </div>

                        <!-- Sort Dropdown -->
                        <div class="admin-sort-box">
                            <label for="borrowingsSort" class="sort-label">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="sort-icon">
                                    <path d="M3 6h18M7 12h10M11 18h2"></path>
                                </svg>
                                Sort:
                            </label>
                            <select id="borrowingsSort" class="filter-select" onchange="filterBorrowings()">
                                <option value="default">Default</option>
                                <option value="borrow-asc">Borrow Date (Oldest)</option>
                                <option value="borrow-desc">Borrow Date (Newest)</option>
                                <option value="due-asc">Due Date (Earliest)</option>
                                <option value="due-desc">Due Date (Latest)</option>
                                <option value="book-asc">Book Title (A-Z)</option>
                                <option value="book-desc">Book Title (Z-A)</option>
                                <option value="customer-asc">Customer (A-Z)</option>
                                <option value="customer-desc">Customer (Z-A)</option>
                            </select>
                        </div>
                    </div>

                    <div class="admin-filter-row">
                        <!-- Status Filter -->
                        <div class="admin-filter-group">
                            <label for="borrowingsStatusFilter" class="filter-label">Status</label>
                            <select id="borrowingsStatusFilter" class="filter-select" onchange="filterBorrowings()">
                                <option value="">Active Borrowings</option>
                                <option value="Borrowed">Currently Borrowed</option>
                                <option value="Overdue">Overdue</option>
                                <option value="Returned">Returned (History)</option>
                                <option value="all">All Borrowings</option>
                            </select>
                        </div>

                        <!-- Clear Filters Button -->
                        <button type="button" class="btn btn-secondary btn-clear-filters" onclick="clearBorrowingFilters()">
                            Clear Filters
                        </button>
                    </div>
                </div>

                <!-- Borrowings Statistics -->
                <div class="borrowings-stats">
                    <div class="stat-card">
                        <div class="stat-icon borrowed">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                                <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                            </svg>
                        </div>
                        <div class="stat-info">
                            <span class="stat-number" id="totalBorrowedCount">0</span>
                            <span class="stat-label">Currently Borrowed</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon overdue">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="12" cy="12" r="10"></circle>
                                <line x1="12" y1="8" x2="12" y2="12"></line>
                                <line x1="12" y1="16" x2="12.01" y2="16"></line>
                            </svg>
                        </div>
                        <div class="stat-info">
                            <span class="stat-number" id="overdueCount">0</span>
                            <span class="stat-label">Overdue</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon returned">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <polyline points="20 6 9 17 4 12"></polyline>
                            </svg>
                        </div>
                        <div class="stat-info">
                            <span class="stat-number" id="returnedCount">0</span>
                            <span class="stat-label">Returned This Month</span>
                        </div>
                    </div>
                </div>

                <div class="table-container">
                    <table class="books-table borrowings-table" id="borrowingsTable">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Book Title</th>
                                <th>Customer</th>
                                <th>Borrow Date</th>
                                <th>Due Date</th>
                                <th>Return Date</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="borrowingsTableBody">
                            <!-- Borrowings will be dynamically rendered here -->
                        </tbody>
                    </table>

                    <div id="borrowingsEmptyState" class="empty-state" style="display: none;">
                        <p>No borrowing records found.</p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Add/Edit Book Modal -->
    <div id="bookModal" class="modal">
        <div class="modal-overlay" onclick="closeBookModal()"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">Add New Book</h2>
                <button class="modal-close" onclick="closeBookModal()">&times;</button>
            </div>
            <form id="bookForm" class="modal-body">
                <input type="hidden" id="bookId">

                <div class="form-row">
                    <div class="form-group">
                        <label for="bookIsbn" class="form-label">ISBN <span class="required">*</span></label>
                        <input
                            type="text"
                            id="bookIsbn"
                            class="form-input"
                            placeholder="Enter ISBN (e.g., 978-3-16-148410-0)"
                            oninput="validateIsbnField(this)"
                            required
                        >
                    </div>

                    <div class="form-group">
                        <label for="bookTitle" class="form-label">Title <span class="required">*</span></label>
                        <input
                            type="text"
                            id="bookTitle"
                            class="form-input"
                            placeholder="Enter book title"
                            required
                        >
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="bookAuthor" class="form-label">Author <span class="required">*</span></label>
                        <input
                            type="text"
                            id="bookAuthor"
                            class="form-input"
                            placeholder="Enter author name"
                            oninput="validateNameField(this)"
                            required
                        >
                    </div>

                    <div class="form-group">
                        <label for="bookGenre" class="form-label">Genre <span class="required">*</span></label>
                        <select id="bookGenre" class="form-input" required>
                            <option value="">Select a genre</option>
                            <!-- Options populated dynamically from database -->
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="bookPublisher" class="form-label">Publisher</label>
                        <select id="bookPublisher" class="form-input">
                            <option value="">Select a publisher</option>
                            <!-- Options populated dynamically from database -->
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="bookYear" class="form-label">Publication Year</label>
                        <input
                            type="number"
                            id="bookYear"
                            class="form-input"
                            placeholder="Enter publication year"
                            min="1000"
                            max="2100"
                        >
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="bookEdition" class="form-label">Edition</label>
                        <input
                            type="text"
                            id="bookEdition"
                            class="form-input"
                            placeholder="e.g., 1st Edition, Revised"
                        >
                    </div>

                    <div class="form-group">
                        <label for="bookLanguage" class="form-label">Language</label>
                        <select id="bookLanguage" class="form-input">
                            <option value="English">English</option>
                            <option value="Arabic">Arabic</option>
                            <option value="French">French</option>
                            <option value="Spanish">Spanish</option>
                            <option value="German">German</option>
                            <option value="Chinese">Chinese</option>
                            <option value="Japanese">Japanese</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="bookPageCount" class="form-label">Page Count</label>
                        <input
                            type="number"
                            id="bookPageCount"
                            class="form-input"
                            placeholder="Number of pages"
                            min="1"
                            max="10000"
                            oninput="validatePageCountField(this)"
                        >
                    </div>

                    <div class="form-group">
                        <label for="bookTotalCopies" class="form-label">Total Copies</label>
                        <input
                            type="number"
                            id="bookTotalCopies"
                            class="form-input"
                            placeholder="Number of copies"
                            min="1"
                            max="10000"
                            value="1"
                            oninput="validateCopiesField(this)"
                        >
                    </div>
                </div>

                <div class="form-group">
                    <label for="bookDescription" class="form-label">Description</label>
                    <textarea
                        id="bookDescription"
                        class="form-input form-textarea"
                        placeholder="Enter book description"
                        rows="3"
                    ></textarea>
                </div>

                <div class="form-group">
                    <label class="form-label">Book Cover Image</label>
                    
                    <div class="image-upload-section">
                        <label for="bookImageFile" class="upload-label">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                <polyline points="17 8 12 3 7 8"></polyline>
                                <line x1="12" y1="3" x2="12" y2="15"></line>
                            </svg>
                            <span>Upload Image</span>
                        </label>
                        <input 
                            type="file" 
                            id="bookImageFile" 
                            accept="image/*"
                            onchange="handleImageUpload(event)"
                            style="display: none;"
                        >
                    </div>
                    
                    <div class="or-divider">
                        <span>OR</span>
                    </div>
                    
                    <input 
                        type="url" 
                        id="bookImageUrl" 
                        class="form-input" 
                        placeholder="Enter image URL"
                        onchange="handleImageUrlChange()"
                    >
                    
                    <div class="image-preview-container">
                        <img id="imagePreview" class="image-preview" style="display: none;">
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeBookModal()">
                        Cancel
                    </button>
                    <button type="submit" class="btn btn-primary" id="saveBookBtn">
                        Save Book
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add/Edit User Modal (Customer/Admin) -->
    <div id="userModal" class="modal">
        <div class="modal-overlay" onclick="closeUserModal()"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="userModalTitle">Add New User</h2>
                <button class="modal-close" onclick="closeUserModal()">&times;</button>
            </div>
            <form id="userForm" class="modal-body">
                <input type="hidden" id="userId">
                <input type="hidden" id="userType">
                <input type="hidden" id="userAdminType">
                
                <!-- Name Fields Row -->
                <div class="form-row">
                    <div class="form-group">
                        <label for="userFirstName" class="form-label">First Name <span class="required">*</span></label>
                        <input
                            type="text"
                            id="userFirstName"
                            class="form-input"
                            placeholder="Enter first name"
                            oninput="validateNameField(this)"
                            required
                        >
                    </div>
                    <div class="form-group">
                        <label for="userLastName" class="form-label">Last Name <span class="required">*</span></label>
                        <input
                            type="text"
                            id="userLastName"
                            class="form-input"
                            placeholder="Enter last name"
                            oninput="validateNameField(this)"
                            required
                        >
                    </div>
                </div>

                <div class="form-group">
                    <label for="userEmail" class="form-label">Email Address <span class="required">*</span></label>
                    <input
                        type="email"
                        id="userEmail"
                        class="form-input"
                        placeholder="Enter email address"
                        oninput="validateEmailField(this)"
                        required
                    >
                </div>

                <div class="form-group">
                    <label for="userPassword" class="form-label">Password <span class="required" id="passwordRequired">*</span></label>
                    <input 
                        type="password" 
                        id="userPassword" 
                        class="form-input" 
                        placeholder="Enter password (min 6 characters)"
                        minlength="6"
                    >
                    <small class="form-hint" id="passwordHint" style="display: none;">Leave blank to keep current password</small>
                </div>

                <!-- Contact Fields Row -->
                <div class="form-row">
                    <div class="form-group">
                        <label for="userPhone" class="form-label">Phone Number</label>
                        <input
                            type="tel"
                            id="userPhone"
                            class="form-input"
                            placeholder="e.g. +966-50-123-4567"
                            oninput="validatePhoneField(this)"
                        >
                    </div>
                    <div class="form-group">
                        <label for="userDateOfBirth" class="form-label">Date of Birth</label>
                        <input
                            type="date"
                            id="userDateOfBirth"
                            class="form-input"
                            onchange="validateDOBField(this)"
                        >
                    </div>
                </div>

                <div class="form-group">
                    <label for="userAddress" class="form-label">Address</label>
                    <textarea 
                        id="userAddress" 
                        class="form-input form-textarea" 
                        placeholder="Enter address"
                        rows="2"
                    ></textarea>
                </div>

                <!-- Admin-specific fields -->
                <div id="adminFields" style="display: none;">
                    <div class="form-group">
                        <label for="userNationalId" class="form-label">National ID</label>
                        <input
                            type="text"
                            id="userNationalId"
                            class="form-input"
                            placeholder="Enter 16-digit national ID (numbers only)"
                            maxlength="16"
                            oninput="validateNationalIdField(this)"
                        >
                    </div>
                </div>

                <div class="form-group" id="roleGroup" style="display: none;">
                    <label for="userRole" class="form-label">Admin Role <span class="required">*</span></label>
                    <select id="userRole" class="form-input">
                        <option value="Admin">Admin (Book Management Only)</option>
                        <option value="Super Admin">Super Admin (Full Access)</option>
                    </select>
                </div>

                <!-- Customer-specific fields -->
                <div id="customerFields" style="display: none;">
                    <div class="form-group">
                        <label for="userMembershipEnd" class="form-label">Membership End Date</label>
                        <input
                            type="date"
                            id="userMembershipEnd"
                            class="form-input"
                            onchange="validateMembershipEndField(this)"
                        >
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeUserModal()">
                        Cancel
                    </button>
                    <button type="submit" class="btn btn-primary" id="saveUserBtn">
                        Save User
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Borrow/Return Modal -->
    <div id="borrowModal" class="modal">
        <div class="modal-overlay" onclick="closeBorrowModal()"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="borrowModalTitle">Manage Book Borrowing</h2>
                <button class="modal-close" onclick="closeBorrowModal()">&times;</button>
            </div>
            <form id="borrowForm" class="modal-body">
                <input type="hidden" id="borrowBookId">

                <!-- Book Availability Info -->
                <div id="bookAvailabilityInfo" class="availability-info-box">
                    <div class="availability-header">
                        <span id="availabilityBookTitle" class="book-title-display"></span>
                    </div>
                    <div class="availability-details">
                        <div class="availability-stat">
                            <span class="stat-label">Total Copies:</span>
                            <span id="totalCopiesDisplay" class="stat-value">0</span>
                        </div>
                        <div class="availability-stat">
                            <span class="stat-label">Available:</span>
                            <span id="availableCopiesDisplay" class="stat-value available">0</span>
                        </div>
                        <div class="availability-stat">
                            <span class="stat-label">Borrowed:</span>
                            <span id="borrowedCopiesDisplay" class="stat-value borrowed">0</span>
                        </div>
                    </div>
                    <div id="nextAvailableInfo" class="next-available-info" style="display: none;">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="info-icon">
                            <circle cx="12" cy="12" r="10"></circle>
                            <polyline points="12 6 12 12 16 14"></polyline>
                        </svg>
                        <span>Next copy available: <strong id="nextAvailableDateDisplay"></strong></span>
                    </div>
                </div>

                <div id="borrowFormContent">
                    <div class="form-group">
                        <label for="borrowMember" class="form-label">Select Customer <span class="required">*</span></label>
                        <select id="borrowMember" class="form-input" required>
                            <option value="">Select a customer</option>
                            <!-- Members will be populated dynamically -->
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="borrowDate" class="form-label">Borrow Date <span class="required">*</span></label>
                        <input
                            type="date"
                            id="borrowDate"
                            class="form-input"
                            required
                        >
                    </div>

                    <div class="form-group">
                        <label for="borrowDuration" class="form-label">Borrowing Duration <span class="required">*</span></label>
                        <select id="borrowDuration" class="form-input" onchange="updateReturnDate()" required>
                            <option value="7">7 Days</option>
                            <option value="14" selected>14 Days</option>
                            <option value="30">30 Days</option>
                            <option value="60">60 Days</option>
                            <option value="custom">Custom Duration</option>
                        </select>
                    </div>

                    <div class="form-group" id="customDurationGroup" style="display: none;">
                        <label for="customDuration" class="form-label">Custom Days</label>
                        <input
                            type="number"
                            id="customDuration"
                            class="form-input"
                            placeholder="Enter number of days"
                            min="1"
                            max="365"
                            onchange="updateReturnDate()"
                        >
                    </div>

                    <div class="form-group">
                        <label for="returnDate" class="form-label">Expected Return Date</label>
                        <input
                            type="date"
                            id="returnDate"
                            class="form-input"
                            readonly
                        >
                    </div>

                    <div class="form-group">
                        <label for="borrowNotes" class="form-label">Notes (Optional)</label>
                        <textarea
                            id="borrowNotes"
                            class="form-input form-textarea"
                            placeholder="Add any notes about this borrowing"
                            rows="2"
                        ></textarea>
                    </div>
                </div>

                <div id="returnFormContent" style="display: none;">
                    <p class="return-confirm-text">Mark this book as returned?</p>
                    <div class="borrow-info-display">
                        <p><strong>Borrowed by:</strong> <span id="displayBorrower"></span></p>
                        <p><strong>Borrow Date:</strong> <span id="displayBorrowDate"></span></p>
                        <p><strong>Due Date:</strong> <span id="displayReturnDate"></span></p>
                        <p id="overdueWarning" class="overdue-warning" style="display: none;">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="warning-icon">
                                <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
                                <line x1="12" y1="9" x2="12" y2="13"></line>
                                <line x1="12" y1="17" x2="12.01" y2="17"></line>
                            </svg>
                            <span>This book is <strong id="overdueDays"></strong> days overdue!</span>
                        </p>
                    </div>
                </div>

                <div id="noCopiesAvailable" class="no-copies-warning" style="display: none;">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="warning-icon">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="12" y1="8" x2="12" y2="12"></line>
                        <line x1="12" y1="16" x2="12.01" y2="16"></line>
                    </svg>
                    <span>No copies available for borrowing. All copies are currently borrowed.</span>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeBorrowModal()">
                        Cancel
                    </button>
                    <button type="submit" class="btn btn-primary" id="saveBorrowBtn">
                        Confirm Borrowing
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="deleteModal" class="modal">
        <div class="modal-overlay" onclick="closeDeleteModal()"></div>
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h2>Confirm Delete</h2>
                <button class="modal-close" onclick="closeDeleteModal()">&times;</button>
            </div>
            <div class="modal-body">
                <p id="deleteMessage">Are you sure you want to delete this item?</p>
                <p class="text-muted" id="deleteItemName"></p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeDeleteModal()">
                    Cancel
                </button>
                <button type="button" class="btn btn-danger" onclick="confirmDelete()">
                    Delete
                </button>
            </div>
        </div>
    </div>

    <!-- Borrowing Details Modal -->
    <div id="borrowingDetailsModal" class="modal">
        <div class="modal-overlay" onclick="closeBorrowingDetailsModal()"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h2>Borrowing Details</h2>
                <button class="modal-close" onclick="closeBorrowingDetailsModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="borrowing-details-container">
                    <!-- Book Info Section -->
                    <div class="detail-section">
                        <div class="detail-section-header">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="section-icon">
                                <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                                <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                            </svg>
                            <h3>Book Information</h3>
                        </div>
                        <div class="detail-content">
                            <div class="detail-row">
                                <span class="detail-label">Title</span>
                                <span class="detail-value" id="detailBorrowingBookTitle">-</span>
                            </div>
                        </div>
                    </div>

                    <!-- Customer Info Section -->
                    <div class="detail-section">
                        <div class="detail-section-header">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="section-icon">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                <circle cx="12" cy="7" r="4"></circle>
                            </svg>
                            <h3>Customer Information</h3>
                        </div>
                        <div class="detail-content">
                            <div class="detail-row">
                                <span class="detail-label">Name</span>
                                <span class="detail-value" id="detailBorrowingCustomerName">-</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Email</span>
                                <span class="detail-value" id="detailBorrowingCustomerEmail">-</span>
                            </div>
                        </div>
                    </div>

                    <!-- Borrowing Info Section -->
                    <div class="detail-section">
                        <div class="detail-section-header">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="section-icon">
                                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                                <line x1="16" y1="2" x2="16" y2="6"></line>
                                <line x1="8" y1="2" x2="8" y2="6"></line>
                                <line x1="3" y1="10" x2="21" y2="10"></line>
                            </svg>
                            <h3>Borrowing Information</h3>
                        </div>
                        <div class="detail-content">
                            <div class="detail-row">
                                <span class="detail-label">Borrow Date</span>
                                <span class="detail-value" id="detailBorrowingBorrowDate">-</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Due Date</span>
                                <span class="detail-value" id="detailBorrowingDueDate">-</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Return Date</span>
                                <span class="detail-value" id="detailBorrowingReturnDate">-</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Status</span>
                                <span class="detail-value" id="detailBorrowingStatus">-</span>
                            </div>
                        </div>
                    </div>

                    <!-- Notes Section -->
                    <div class="detail-section">
                        <div class="detail-section-header">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="section-icon">
                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                <polyline points="14 2 14 8 20 8"></polyline>
                                <line x1="16" y1="13" x2="8" y2="13"></line>
                                <line x1="16" y1="17" x2="8" y2="17"></line>
                            </svg>
                            <h3>Notes</h3>
                        </div>
                        <div class="detail-content">
                            <p class="detail-notes" id="detailBorrowingNotes">No notes available</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeBorrowingDetailsModal()">
                    Close
                </button>
                <button type="button" class="btn btn-success" id="detailReturnBtn" onclick="returnFromDetailsModal()" style="display: none;">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="btn-icon-svg">
                        <polyline points="20 6 9 17 4 12"></polyline>
                    </svg>
                    Mark as Returned
                </button>
            </div>
        </div>
    </div>

    <!-- Include JavaScript -->
    <script src="assets/js/app.js"></script>
    <script>
        // Initialize super admin dashboard
        initSuperAdminPage();
    </script>
</body>
</html>

